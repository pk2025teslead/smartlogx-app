{% extends 'adminpanel/base_admin.html' %}
{% load static %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="zoho-page-header" data-aos="fade-down">
    <div>
        <h1 class="zoho-page-title">Admin Dashboard</h1>
        <p class="zoho-page-subtitle">{{ current_month }} Overview</p>
    </div>
</div>

<!-- Stats Cards -->
<div class="zoho-stats-grid" data-aos="fade-up" data-aos-delay="100">
    <div class="zoho-stat-card">
        <div class="zoho-stat-icon blue"><i class="bi bi-people-fill"></i></div>
        <div><div class="zoho-stat-value">{{ stats.total_users }}</div><div class="zoho-stat-label">Total Users</div></div>
    </div>
    <div class="zoho-stat-card">
        <div class="zoho-stat-icon" style="background:rgba(239,68,68,0.15);color:#ef4444;"><i class="bi bi-calendar-x"></i></div>
        <div><div class="zoho-stat-value">{{ stats.leaves.total }}</div><div class="zoho-stat-label">Leaves ({{ stats.leaves.pending }} pending)</div></div>
    </div>
    <div class="zoho-stat-card">
        <div class="zoho-stat-icon green"><i class="bi bi-calendar-plus"></i></div>
        <div><div class="zoho-stat-value">{{ stats.compoffs.total }}</div><div class="zoho-stat-label">Comp-Offs ({{ stats.compoffs.pending }} pending)</div></div>
    </div>
    <div class="zoho-stat-card">
        <div class="zoho-stat-icon purple"><i class="bi bi-house"></i></div>
        <div><div class="zoho-stat-value">{{ stats.wfh.total }}</div><div class="zoho-stat-label">WFH ({{ stats.wfh.pending }} pending)</div></div>
    </div>
    <div class="zoho-stat-card">
        <div class="zoho-stat-icon yellow"><i class="bi bi-journal-text"></i></div>
        <div><div class="zoho-stat-value">{{ stats.logs.total }}</div><div class="zoho-stat-label">Logs This Month</div></div>
    </div>
</div>

<!-- Quick Links -->
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px;" data-aos="fade-up" data-aos-delay="150">
    <a href="{% url 'adminpanel:leave_list' %}" class="zoho-card" style="padding:20px;text-decoration:none;display:flex;align-items:center;gap:12px;">
        <div style="width:40px;height:40px;background:rgba(239,68,68,0.15);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#ef4444;"><i class="bi bi-calendar-x"></i></div>
        <div><div style="font-weight:600;color:var(--zoho-text-primary);">Leave Management</div><div style="font-size:12px;color:var(--zoho-text-muted);">{{ stats.leaves.pending }} pending</div></div>
    </a>
    <a href="{% url 'adminpanel:compoff_list' %}" class="zoho-card" style="padding:20px;text-decoration:none;display:flex;align-items:center;gap:12px;">
        <div style="width:40px;height:40px;background:rgba(16,185,129,0.15);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#10b981;"><i class="bi bi-calendar-plus"></i></div>
        <div><div style="font-weight:600;color:var(--zoho-text-primary);">Comp-Off Management</div><div style="font-size:12px;color:var(--zoho-text-muted);">{{ stats.compoffs.pending }} pending</div></div>
    </a>
    <a href="{% url 'adminpanel:wfh_list' %}" class="zoho-card" style="padding:20px;text-decoration:none;display:flex;align-items:center;gap:12px;">
        <div style="width:40px;height:40px;background:rgba(139,92,246,0.15);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#8b5cf6;"><i class="bi bi-house"></i></div>
        <div><div style="font-weight:600;color:var(--zoho-text-primary);">WFH Management</div><div style="font-size:12px;color:var(--zoho-text-muted);">{{ stats.wfh.pending }} pending</div></div>
    </a>
    <a href="{% url 'adminpanel:log_list' %}" class="zoho-card" style="padding:20px;text-decoration:none;display:flex;align-items:center;gap:12px;">
        <div style="width:40px;height:40px;background:rgba(245,158,11,0.15);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#f59e0b;"><i class="bi bi-journal-text"></i></div>
        <div><div style="font-weight:600;color:var(--zoho-text-primary);">Log Management</div><div style="font-size:12px;color:var(--zoho-text-muted);">{{ stats.logs.total }} this month</div></div>
    </a>
</div>

<!-- Recent Activity -->
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:24px;">
    <!-- Recent Leaves -->
    <div class="zoho-card" data-aos="fade-up" data-aos-delay="200">
        <div class="zoho-card-header"><h3 class="zoho-card-title"><i class="bi bi-calendar-x" style="margin-right:8px;color:#ef4444;"></i>Recent Leaves</h3></div>
        <div class="zoho-card-body" style="padding:0;">
            {% for leave in recent_leaves %}
            <div style="padding:12px 20px;border-bottom:1px solid var(--zoho-border);display:flex;justify-content:space-between;align-items:center;">
                <div><div style="font-weight:500;">{{ leave.EMP_NAME }}</div><div style="font-size:12px;color:var(--zoho-text-muted);">{{ leave.LEAVE_DATE|date:"d M" }} - {{ leave.LEAVE_TYPE }}</div></div>
                <span class="status-badge {% if leave.IS_APPROVED == 1 %}approved{% elif leave.IS_APPROVED == 0 %}rejected{% else %}pending{% endif %}">{% if leave.IS_APPROVED == 1 %}Approved{% elif leave.IS_APPROVED == 0 %}Rejected{% else %}Pending{% endif %}</span>
            </div>
            {% empty %}<div style="padding:20px;text-align:center;color:var(--zoho-text-muted);">No recent leaves</div>{% endfor %}
        </div>
    </div>
    
    <!-- Recent Logs -->
    <div class="zoho-card" data-aos="fade-up" data-aos-delay="300">
        <div class="zoho-card-header"><h3 class="zoho-card-title"><i class="bi bi-journal-text" style="margin-right:8px;color:#f59e0b;"></i>Recent Logs</h3></div>
        <div class="zoho-card-body" style="padding:0;">
            {% for log in recent_logs %}
            <div style="padding:12px 20px;border-bottom:1px solid var(--zoho-border);">
                <div style="font-weight:500;">{{ log.PROJECT_TITLE|truncatechars:30 }}</div>
                <div style="font-size:12px;color:var(--zoho-text-muted);">{{ log.EMP_NAME }} - {{ log.LOG_DATE|date:"d M" }}</div>
            </div>
            {% empty %}<div style="padding:20px;text-align:center;color:var(--zoho-text-muted);">No recent logs</div>{% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.status-badge{display:inline-flex;align-items:center;padding:4px 10px;border-radius:12px;font-size:11px;font-weight:500;}
.status-badge.approved{background:rgba(16,185,129,0.15);color:#10b981;}
.status-badge.rejected{background:rgba(239,68,68,0.15);color:#ef4444;}
.status-badge.pending{background:rgba(245,158,11,0.15);color:#f59e0b;}
</style>
{% endblock %}
